{% extends "base.html" %}

{% block title %}CareerGuideAI - Get Your Personalized Career Guidance{% endblock %}

{% block extra_css %}
<style>
    /* Mobile-specific optimizations for the form */
    @media (max-width: 768px) {
        /* Form layout mobile optimization */
        .row.mb-4 .col-md-6 {
            margin-bottom: 1rem;
        }
        
        /* Input groups mobile optimization */
        .input-group {
            flex-direction: column;
        }
        
        .input-group .form-control {
            border-radius: 10px 10px 0 0 !important;
            margin-bottom: 0.5rem;
        }
        
        .input-group .btn {
            border-radius: 0 0 10px 10px !important;
            margin-bottom: 0;
        }
        
        /* Skill suggestions mobile */
        .skill-suggestion {
            font-size: 0.8rem !important;
            padding: 8px 12px !important;
            margin: 2px !important;
        }
        
        /* Loading spinner mobile */
        .spinner-border {
            width: 2rem !important;
            height: 2rem !important;
        }
        
        /* Feature grid mobile */
        .row.g-3 .col-md-3 {
            margin-bottom: 1rem;
        }
        
        /* Hero section mobile text */
        .hero-title {
            font-size: 2.2rem !important;
            line-height: 1.1;
        }
        
        .hero-subtitle {
            font-size: 1rem !important;
            line-height: 1.3;
        }
    }
    
    /* Extra small devices */
    @media (max-width: 576px) {
        .hero-title {
            font-size: 1.8rem !important;
        }
        
        .hero-subtitle {
            font-size: 0.9rem !important;
        }
        
        .card-title {
            font-size: 1.5rem !important;
        }
        
        .feature-icon {
            width: 50px !important;
            height: 50px !important;
            font-size: 1.2rem !important;
        }
    }
    
    /* Touch-friendly interactions */
    @media (hover: none) and (pointer: coarse) {
        .skill-tag {
            cursor: pointer;
            user-select: none;
        }
        
        .skill-suggestion {
            cursor: pointer;
            user-select: none;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section text-center">
    <div class="row align-items-center">
        <div class="col-lg-8 mx-auto">
            <h1 class="hero-title text-white">
                ðŸš€ CareerGuideAI
            </h1>
            <p class="hero-subtitle mb-4">
                Your advanced AI career counselor and future skill forecaster. 
                Get personalized career recommendations, skill gap analysis, and learning roadmaps.
            </p>
            <div class="row g-3 mb-4">
                <div class="col-md-3">
                    <div class="feature-icon mx-auto">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h6>AI-Powered</h6>
                </div>
                <div class="col-md-3">
                    <div class="feature-icon mx-auto">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h6>Future Trends</h6>
                </div>
                <div class="col-md-3">
                    <div class="feature-icon mx-auto">
                        <i class="fas fa-road"></i>
                    </div>
                    <h6>Learning Paths</h6>
                </div>
                <div class="col-md-3">
                    <div class="feature-icon mx-auto">
                        <i class="fas fa-certificate"></i>
                    </div>
                    <h6>Certifications</h6>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Career Guidance Form -->
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body p-4">
                <h3 class="card-title text-center mb-4">
                    <i class="fas fa-user-graduate me-2"></i>
                    Your Career Profile
                </h3>
                
                <form id="careerForm">
                    <!-- Basic Information -->
                    <div class="row mb-4">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">
                                <i class="fas fa-user me-2"></i>Full Name
                            </label>
                            <input type="text" class="form-control" id="name" name="name" placeholder="Enter your full name">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="education" class="form-label">
                                <i class="fas fa-graduation-cap me-2"></i>Education Level
                            </label>
                            <select class="form-select" id="education" name="education">
                                <option value="">Select education level</option>
                                <option value="High School">High School</option>
                                <option value="Bachelor's Degree">Bachelor's Degree</option>
                                <option value="Master's Degree">Master's Degree</option>
                                <option value="PhD">PhD</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>

                    <!-- Experience Level -->
                    <div class="mb-4">
                        <label for="experience" class="form-label">
                            <i class="fas fa-briefcase me-2"></i>Experience Level
                        </label>
                        <select class="form-select" id="experience" name="experience">
                            <option value="">Select experience level</option>
                            <option value="student">Student</option>
                            <option value="fresher">Fresher (0-1 years)</option>
                            <option value="junior">Junior (1-3 years)</option>
                            <option value="mid">Mid-level (3-5 years)</option>
                            <option value="senior">Senior (5+ years)</option>
                        </select>
                    </div>

                    <!-- Skills Section -->
                    <div class="mb-4">
                        <label class="form-label">
                            <i class="fas fa-tools me-2"></i>Skills
                        </label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="skillInput" placeholder="Type a skill and press Enter">
                            <button class="btn btn-outline-secondary" type="button" id="addSkill">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div class="form-text">Press Enter or click + to add skills</div>
                        <div id="skillsContainer" class="mt-3">
                            <!-- Skills will be added here -->
                        </div>
                        <div id="skillSuggestions" class="mt-2">
                            <!-- Skill suggestions will appear here -->
                        </div>
                    </div>

                    <!-- Interests Section -->
                    <div class="mb-4">
                        <label class="form-label">
                            <i class="fas fa-heart me-2"></i>Interests
                        </label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="interestInput" placeholder="Type an interest and press Enter">
                            <button class="btn btn-outline-secondary" type="button" id="addInterest">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div class="form-text">Press Enter or click + to add interests</div>
                        <div id="interestsContainer" class="mt-3">
                            <!-- Interests will be added here -->
                        </div>
                    </div>

                    <!-- Learning Style -->
                    <div class="mb-4">
                        <label for="learningStyle" class="form-label">
                            <i class="fas fa-book-open me-2"></i>Learning Style (Optional)
                        </label>
                        <select class="form-select" id="learningStyle" name="learningStyle">
                            <option value="">Select learning style</option>
                            <option value="visual">Visual Learner</option>
                            <option value="auditory">Auditory Learner</option>
                            <option value="kinesthetic">Kinesthetic Learner</option>
                            <option value="reading">Reading/Writing Learner</option>
                        </select>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg" id="analyzeBtn">
                            <i class="fas fa-magic me-2"></i>
                            Analyze My Career Path
                        </button>
                        <br><br>

                    </div>
                </form>

                <!-- Loading Spinner -->
                <div class="loading text-center mt-4" id="loading">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-3">Analyzing your profile and generating recommendations...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Features Section -->
<div class="row mt-5">
    <div class="col-12">
        <h3 class="text-center mb-4">Why Choose CareerGuideAI?</h3>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <div class="feature-icon mx-auto">
                    <i class="fas fa-robot"></i>
                </div>
                <h5>AI-Powered Analysis</h5>
                <p>Advanced algorithms analyze your skills, interests, and market trends to provide personalized recommendations.</p>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <div class="feature-icon mx-auto">
                    <i class="fas fa-crystal-ball"></i>
                </div>
                <h5>Future Skill Prediction</h5>
                <p>Stay ahead with predictions of emerging skills and technologies that will be in high demand.</p>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-4">
        <div class="card h-100 text-center">
            <div class="card-body">
                <div class="feature-icon mx-auto">
                    <i class="fas fa-map-marked-alt"></i>
                </div>
                <h5>Personalized Roadmap</h5>
                <p>Get a detailed learning path with phases, projects, and certifications tailored to your goals.</p>
            </div>
        </div>
    </div>
</div>
<!-- Features Section End -->

<!-- About Section -->
<div class="row mt-5">
    <div class="col-12">
        <h3 class="text-center mb-4">About CareerGuideAI</h3>
        <div class="card mx-auto" style="max-width: 800px;">
            <div class="card-body">
                <p>
                    <strong>CareerGuideAI</strong> is an advanced AI-powered platform designed to help individuals make informed career decisions. By analyzing your education, experience, skills, and interests, our system provides personalized career recommendations, skill gap analysis, and learning roadmaps tailored to your goals. Stay ahead of the curve with insights into future skill trends and emerging opportunities.
                </p>
                <p>
                    Whether you're a student, a professional looking to switch fields, or someone seeking to upskill, CareerGuideAI is your trusted partner for career growth and lifelong learning.
                </p>
            </div>
        </div>
    </div>
</div>

<!-- About Section -->
<section id="about" class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <h2 class="gradient-text mb-4">
                    <i class="fas fa-info-circle me-2"></i>About CareerGuideAI
                </h2>
                <div class="card">
                    <div class="card-body p-4">
                        <p class="lead mb-4">
                            CareerGuideAI is an advanced AI-powered career guidance system designed to help individuals 
                            make informed decisions about their professional development and career paths.
                        </p>
                        
                        <div class="row g-4 mb-4">
                            <div class="col-md-6">
                                <div class="feature-icon mx-auto mb-3">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <h5>AI-Powered Analysis</h5>
                                <p class="text-muted">
                                    Our advanced AI algorithms analyze your skills, experience, and interests to provide 
                                    personalized career recommendations with high accuracy.
                                </p>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-icon mx-auto mb-3">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h5>Market Intelligence</h5>
                                <p class="text-muted">
                                    Get insights into current market demands, future trends, and emerging skills that 
                                    will shape the job market in the coming years.
                                </p>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-icon mx-auto mb-3">
                                    <i class="fas fa-road"></i>
                                </div>
                                <h5>Learning Roadmaps</h5>
                                <p class="text-muted">
                                    Receive structured learning paths with timelines, recommended courses, and projects 
                                    to help you achieve your career goals.
                                </p>
                            </div>
                            <div class="col-md-6">
                                <div class="feature-icon mx-auto mb-3">
                                    <i class="fas fa-file-pdf"></i>
                                </div>
                                <h5>Professional Reports</h5>
                                <p class="text-muted">
                                    Download comprehensive PDF reports with detailed analysis, skill gaps, and actionable 
                                    recommendations for your career development.
                                </p>
                            </div>
                        </div>
                        
                        <div class="row g-4">
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h4 class="text-primary">8+</h4>
                                    <p class="text-muted">Career Tracks</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h4 class="text-primary">100+</h4>
                                    <p class="text-muted">Skills Analyzed</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <h4 class="text-primary">24/7</h4>
                                    <p class="text-muted">Available</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section id="contact" class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center">
                <h2 class="gradient-text mb-4">
                    <i class="fas fa-envelope me-2"></i>Contact Us
                </h2>
                <div class="card">
                    <div class="card-body p-4">
                        <p class="lead mb-4">
                            Have questions about your career guidance or want to learn more about our services? 
                            We're here to help you on your professional journey.
                        </p>
                        
                        <div class="row g-4 mb-4">
                            <div class="col-md-4">
                                <div class="text-center">
                                    <div class="feature-icon mx-auto mb-3">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                    <h5>Email Support</h5>
                                    <p class="text-muted">
                                        Get personalized assistance with your career guidance questions and technical support.
                                    </p>
                                    <a href="mailto:amrutmp2004@gmail.com" class="btn btn-outline-primary">
                                        <i class="fas fa-envelope me-2"></i>Send Email
                                    </a>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <div class="feature-icon mx-auto mb-3">
                                        <i class="fas fa-comments"></i>
                                    </div>
                                    <h5>Live Chat</h5>
                                    <p class="text-muted">
                                        Connect with our career guidance experts for real-time assistance and advice.
                                    </p>
                                    <button class="btn btn-outline-primary" onclick="alert('Live chat feature coming soon!')">
                                        <i class="fas fa-comments me-2"></i>Start Chat
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <div class="feature-icon mx-auto mb-3">
                                        <i class="fas fa-book"></i>
                                    </div>
                                    <h5>Documentation</h5>
                                    <p class="text-muted">
                                        Access comprehensive guides and tutorials to maximize your career guidance experience.
                                    </p>
                                    <a href="https://github.com/Amrut735/Career-Guide-AI" class="btn btn-outline-primary" target="_blank">
                                        <i class="fab fa-github me-2"></i>View Docs
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h5 class="mb-3">
                                    <i class="fas fa-clock me-2"></i>Response Time
                                </h5>
                                <ul class="list-unstyled text-muted">
                                    <li><i class="fas fa-check text-success me-2"></i>Email: Within 24 hours</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Live Chat: Instant</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Documentation: Always available</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5 class="mb-3">
                                    <i class="fas fa-shield-alt me-2"></i>Privacy & Security
                                </h5>
                                <ul class="list-unstyled text-muted">
                                    <li><i class="fas fa-check text-success me-2"></i>Data encryption</li>
                                    <li><i class="fas fa-check text-success me-2"></i>No personal data storage</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Secure HTTPS connection</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Global variables for skills and interests
let skills = [];
let interests = [];
let availableSkills = [];

// Global functions for updating displays
function updateSkillsDisplay() {
    const container = $('#skillsContainer');
    container.empty();
    skills.forEach(skill => {
        container.append(`
            <span class="skill-tag">
                ${skill}
                <i class="fas fa-times ms-2" onclick="removeSkill('${skill}')"></i>
            </span>
        `);
    });
}

function updateInterestsDisplay() {
    const container = $('#interestsContainer');
    container.empty();
    interests.forEach(interest => {
        container.append(`
            <span class="skill-tag">
                ${interest}
                <i class="fas fa-times ms-2" onclick="removeInterest('${interest}')"></i>
            </span>
        `);
    });
}

// Global function for adding skills
function addSkill(skill) {
    if (skill && !skills.includes(skill)) {
        skills.push(skill);
        updateSkillsDisplay();
        $('#skillInput').val('');
    }
}

// Global function for adding interests
function addInterest(interest) {
    if (interest && !interests.includes(interest)) {
        interests.push(interest);
        updateInterestsDisplay();
        $('#interestInput').val('');
    }
}

$(document).ready(function() {

    // Load available skills for autocomplete
    $.get('/api/skills', function(data) {
        availableSkills = data;
    });

    // Add skill functionality (local wrapper for global function)
    function addSkillLocal(skill) {
        addSkill(skill);
    }

    // Add interest functionality (local wrapper for global function)
    function addInterestLocal(interest) {
        addInterest(interest);
    }

    // Skill input handling
    $('#skillInput').on('keypress', function(e) {
        if (e.which === 13) {
            e.preventDefault();
            addSkillLocal($(this).val().trim());
        }
    });

    $('#addSkill').on('click', function() {
        addSkillLocal($('#skillInput').val().trim());
    });

    // Interest input handling
    $('#interestInput').on('keypress', function(e) {
        if (e.which === 13) {
            e.preventDefault();
            addInterestLocal($(this).val().trim());
        }
    });

    $('#addInterest').on('click', function() {
        addInterestLocal($('#interestInput').val().trim());
    });

    // Skill autocomplete
    $('#skillInput').on('input', function() {
        const query = $(this).val().toLowerCase();
        const suggestions = availableSkills.filter(skill => 
            skill.toLowerCase().includes(query) && query.length > 0
        ).slice(0, 5);
        
        const container = $('#skillSuggestions');
        container.empty();
        
        suggestions.forEach(skill => {
            container.append(`
                <span class="badge bg-light text-dark me-2 mb-2 skill-suggestion" style="cursor: pointer;" data-skill="${skill}">
                    ${skill}
                </span>
            `);
        });
    });

    // Handle clicking on skill suggestions
    $(document).on('click', '.skill-suggestion', function() {
        const skill = $(this).data('skill');
        addSkill(skill);
        $('#skillSuggestions').empty(); // Clear suggestions after selection
    });

    // Form submission
    $('#careerForm').on('submit', function(e) {
        e.preventDefault();
        
        // Enhanced validation with better user feedback
        const name = $('#name').val().trim();
        const education = $('#education').val();
        const experience = $('#experience').val();
        
        // Clear previous error messages
        $('.error-message').remove();
        
        let hasErrors = false;
        
        if (!name) {
            $('#name').after('<div class="error-message text-danger mt-1">Name is required</div>');
            hasErrors = true;
        }
        
        if (!education) {
            $('#education').after('<div class="error-message text-danger mt-1">Education level is required</div>');
            hasErrors = true;
        }
        
        if (!experience) {
            $('#experience').after('<div class="error-message text-danger mt-1">Experience level is required</div>');
            hasErrors = true;
        }
        
        if (skills.length === 0) {
            $('#skillsContainer').after('<div class="error-message text-danger mt-1">At least one skill is required</div>');
            hasErrors = true;
        }
        
        if (interests.length === 0) {
            $('#interestsContainer').after('<div class="error-message text-danger mt-1">At least one interest is required</div>');
            hasErrors = true;
        }
        
        if (hasErrors) {
            // Scroll to first error
            $('html, body').animate({
                scrollTop: $('.error-message').first().offset().top - 100
            }, 500);
            return;
        }
        
        const formData = {
            name: name,
            education: education,
            experience: experience,
            skills: skills,
            interests: interests,
            learning_style: $('#learningStyle').val()
        };
        
        // Show loading with better feedback
        $('#loading').addClass('show');
        $('#analyzeBtn').prop('disabled', true);
        $('#analyzeBtn').html('<i class="fas fa-spinner fa-spin me-2"></i>Analyzing...');
        
        console.log('Submitting form data:', formData);
        
        $.ajax({
            url: '/analyze',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(formData),
            timeout: 30000, // 30 second timeout
            success: function(response) {
                console.log('Response received:', response);
                if (response.success) {
                    console.log('Success! Redirecting to results page...');
                    // Store analysis data in localStorage
                    localStorage.setItem('analysis_completed', 'true');
                    localStorage.setItem('analysis_timestamp', Date.now());
                    localStorage.setItem('analysis_data', JSON.stringify(response));
                    
                    // Show success message before redirect
                    $('#loading').html(`
                        <div class="alert alert-success">
                            <i class="fas fa-check-circle me-2"></i>
                            Analysis completed successfully! Redirecting to results...
                        </div>
                    `);
                    
                    // Simple, reliable redirect
                    setTimeout(function() {
                        window.location.href = '/results';
                    }, 1500);
                } else {
                    console.log('Error in response:', response.error);
                    showError('Analysis failed: ' + response.error);
                }
            },
            error: function(xhr, status, error) {
                console.log('AJAX error:', xhr, status, error);
                let errorMessage = 'An error occurred during analysis.';
                
                if (status === 'timeout') {
                    errorMessage = 'Request timed out. Please try again.';
                } else if (xhr.responseJSON && xhr.responseJSON.error) {
                    errorMessage = xhr.responseJSON.error;
                } else if (error) {
                    errorMessage = 'Error: ' + error;
                }
                
                showError(errorMessage);
            },
            complete: function() {
                console.log('Request completed');
                $('#loading').removeClass('show');
                $('#analyzeBtn').prop('disabled', false);
                $('#analyzeBtn').html('<i class="fas fa-magic me-2"></i>Analyze My Career Path');
            }
        });
    });
    
    // Helper function to show errors
    function showError(message) {
        $('#loading').html(`
            <div class="alert alert-danger">
                <i class="fas fa-exclamation-triangle me-2"></i>
                ${message}
                <button type="button" class="btn btn-outline-danger btn-sm ms-3" onclick="location.reload()">
                    <i class="fas fa-redo me-1"></i>Try Again
                </button>
            </div>
        `);
    }
    
    // Simple fallback redirect
    setTimeout(function() {
        if (localStorage.getItem('analysis_completed') === 'true') {
            console.log('Fallback: Redirecting to results page...');
            window.location.href = '/results';
        }
    }, 2000);
});
});

// Smooth scrolling for navigation links
$(document).ready(function() {
    $('a[href^="#"]').on('click', function(e) {
        e.preventDefault();
        const target = $(this.getAttribute('href'));
        if (target.length) {
            $('html, body').animate({
                scrollTop: target.offset().top - 80
            }, 800);
        }
    });
});

// Global functions for removing skills/interests
function removeSkill(skill) {
    const index = skills.indexOf(skill);
    if (index > -1) {
        skills.splice(index, 1);
        updateSkillsDisplay();
    }
}

function removeInterest(interest) {
    const index = interests.indexOf(interest);
    if (index > -1) {
        interests.splice(index, 1);
        updateInterestsDisplay();
    }
}


</script>
{% endblock %} 